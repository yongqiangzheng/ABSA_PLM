cuda memory allocated: 499894784
> n_trainable_params: 124647939, n_nontrainable_params: 0
> training arguments:
>>> model_name: roberta
>>> dataset: lap14
>>> optimizer: adam
>>> repeat: 3
>>> lr: 2e-05
>>> l2reg: 0.0001
>>> num_epoch: 100
>>> batch_size: 16
>>> log_step: 10
>>> bert_dim: 768
>>> max_seq_len: 128
>>> polarities_dim: 3
>>> patience: 5
>>> device: cuda
>>> seed: 42
>>> save_model_dir: /media/b115/Backup/NLP
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.0861, acc: 0.4062
loss: 1.0726, acc: 0.4313
loss: 1.0558, acc: 0.4542
loss: 1.0394, acc: 0.4859
loss: 0.9898, acc: 0.5262
loss: 0.9329, acc: 0.5656
loss: 0.8857, acc: 0.5955
loss: 0.8688, acc: 0.6094
loss: 0.8641, acc: 0.6062
loss: 0.8406, acc: 0.6200
loss: 0.8212, acc: 0.6301
loss: 0.8046, acc: 0.6401
loss: 0.7937, acc: 0.6510
loss: 0.7840, acc: 0.6562
> val_acc: 0.7727, val_f1: 0.7118
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.7727_f1_0.7118_230828-0355.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.6185, acc: 0.7969
loss: 0.5885, acc: 0.7857
loss: 0.5622, acc: 0.7943
loss: 0.5708, acc: 0.7776
loss: 0.5613, acc: 0.7884
loss: 0.5375, acc: 0.8009
loss: 0.5275, acc: 0.8086
loss: 0.5310, acc: 0.8083
loss: 0.5233, acc: 0.8103
loss: 0.5028, acc: 0.8185
loss: 0.5010, acc: 0.8209
loss: 0.4979, acc: 0.8213
loss: 0.4915, acc: 0.8216
loss: 0.4819, acc: 0.8246
loss: 0.4774, acc: 0.8255
> val_acc: 0.7868, val_f1: 0.7394
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.7868_f1_0.7394_230828-0356.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.3164, acc: 0.9141
loss: 0.3231, acc: 0.9132
loss: 0.3673, acc: 0.8728
loss: 0.3901, acc: 0.8602
loss: 0.3923, acc: 0.8620
loss: 0.3804, acc: 0.8621
loss: 0.3572, acc: 0.8713
loss: 0.3456, acc: 0.8750
loss: 0.3290, acc: 0.8821
loss: 0.3257, acc: 0.8833
loss: 0.3328, acc: 0.8802
loss: 0.3303, acc: 0.8808
loss: 0.3235, acc: 0.8828
loss: 0.3199, acc: 0.8832
> val_acc: 0.8103, val_f1: 0.7707
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8103_f1_0.7707_230828-0356.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.3605, acc: 0.8750
loss: 0.2984, acc: 0.9062
loss: 0.2681, acc: 0.9034
loss: 0.2798, acc: 0.8945
loss: 0.2707, acc: 0.8929
loss: 0.2647, acc: 0.8966
loss: 0.2532, acc: 0.9032
loss: 0.2499, acc: 0.9036
loss: 0.2372, acc: 0.9093
loss: 0.2247, acc: 0.9158
loss: 0.2292, acc: 0.9167
loss: 0.2348, acc: 0.9157
loss: 0.2363, acc: 0.9134
loss: 0.2324, acc: 0.9162
loss: 0.2391, acc: 0.9129
> val_acc: 0.7978, val_f1: 0.7543
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.1792, acc: 0.9479
loss: 0.1595, acc: 0.9453
loss: 0.1490, acc: 0.9567
loss: 0.1580, acc: 0.9444
loss: 0.1497, acc: 0.9484
loss: 0.1608, acc: 0.9442
loss: 0.1699, acc: 0.9413
loss: 0.1687, acc: 0.9424
loss: 0.1627, acc: 0.9448
loss: 0.1538, acc: 0.9460
loss: 0.1541, acc: 0.9481
loss: 0.1573, acc: 0.9472
loss: 0.1534, acc: 0.9484
loss: 0.1549, acc: 0.9485
loss: 0.1569, acc: 0.9472
> val_acc: 0.8135, val_f1: 0.7752
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8135_f1_0.7752_230828-0357.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.0601, acc: 0.9875
loss: 0.1102, acc: 0.9656
loss: 0.1326, acc: 0.9604
loss: 0.1312, acc: 0.9609
loss: 0.1245, acc: 0.9587
loss: 0.1237, acc: 0.9594
loss: 0.1256, acc: 0.9580
loss: 0.1197, acc: 0.9594
loss: 0.1216, acc: 0.9604
loss: 0.1198, acc: 0.9606
loss: 0.1196, acc: 0.9602
loss: 0.1165, acc: 0.9620
loss: 0.1186, acc: 0.9615
loss: 0.1214, acc: 0.9612
> val_acc: 0.8025, val_f1: 0.7600
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.1126, acc: 0.9688
loss: 0.0695, acc: 0.9732
loss: 0.0783, acc: 0.9740
loss: 0.0772, acc: 0.9724
loss: 0.0732, acc: 0.9730
loss: 0.0808, acc: 0.9722
loss: 0.0819, acc: 0.9707
loss: 0.0744, acc: 0.9747
loss: 0.0771, acc: 0.9740
loss: 0.0807, acc: 0.9721
loss: 0.0814, acc: 0.9712
loss: 0.0846, acc: 0.9709
loss: 0.0824, acc: 0.9708
loss: 0.0823, acc: 0.9711
loss: 0.0828, acc: 0.9701
> val_acc: 0.8056, val_f1: 0.7625
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.0248, acc: 0.9922
loss: 0.0528, acc: 0.9826
loss: 0.0557, acc: 0.9821
loss: 0.0613, acc: 0.9803
loss: 0.0544, acc: 0.9818
loss: 0.0686, acc: 0.9763
loss: 0.0765, acc: 0.9733
loss: 0.0775, acc: 0.9736
loss: 0.0748, acc: 0.9744
loss: 0.0749, acc: 0.9751
loss: 0.0760, acc: 0.9745
loss: 0.0713, acc: 0.9767
loss: 0.0775, acc: 0.9741
loss: 0.0741, acc: 0.9751
> val_acc: 0.8150, val_f1: 0.7804
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.815_f1_0.7804_230828-0358.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.2069, acc: 0.9375
loss: 0.0815, acc: 0.9688
loss: 0.0540, acc: 0.9830
loss: 0.0600, acc: 0.9805
loss: 0.0502, acc: 0.9836
loss: 0.0503, acc: 0.9832
loss: 0.0481, acc: 0.9829
loss: 0.0475, acc: 0.9826
loss: 0.0475, acc: 0.9832
loss: 0.0468, acc: 0.9844
loss: 0.0550, acc: 0.9822
loss: 0.0596, acc: 0.9799
loss: 0.0657, acc: 0.9775
loss: 0.0673, acc: 0.9763
loss: 0.0683, acc: 0.9762
> val_acc: 0.8119, val_f1: 0.7780
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.0459, acc: 0.9792
loss: 0.1570, acc: 0.9297
loss: 0.2141, acc: 0.9135
loss: 0.2188, acc: 0.9184
loss: 0.2087, acc: 0.9239
loss: 0.1838, acc: 0.9342
loss: 0.1692, acc: 0.9403
loss: 0.1617, acc: 0.9433
loss: 0.1593, acc: 0.9433
loss: 0.1563, acc: 0.9440
loss: 0.1490, acc: 0.9463
loss: 0.1428, acc: 0.9483
loss: 0.1385, acc: 0.9499
loss: 0.1351, acc: 0.9513
loss: 0.1345, acc: 0.9510
> val_acc: 0.8025, val_f1: 0.7669
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.0351, acc: 0.9875
loss: 0.0277, acc: 0.9906
loss: 0.0259, acc: 0.9917
loss: 0.0278, acc: 0.9891
loss: 0.0414, acc: 0.9862
loss: 0.0457, acc: 0.9854
loss: 0.0482, acc: 0.9848
loss: 0.0498, acc: 0.9844
loss: 0.0478, acc: 0.9847
loss: 0.0477, acc: 0.9856
loss: 0.0477, acc: 0.9847
loss: 0.0528, acc: 0.9833
loss: 0.0511, acc: 0.9837
loss: 0.0496, acc: 0.9839
> val_acc: 0.8119, val_f1: 0.7742
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.0753, acc: 0.9688
loss: 0.0762, acc: 0.9777
loss: 0.0577, acc: 0.9818
loss: 0.0615, acc: 0.9798
loss: 0.0530, acc: 0.9830
loss: 0.0502, acc: 0.9826
loss: 0.0450, acc: 0.9844
loss: 0.0462, acc: 0.9840
loss: 0.0437, acc: 0.9844
loss: 0.0475, acc: 0.9827
loss: 0.0472, acc: 0.9820
loss: 0.0469, acc: 0.9830
loss: 0.0507, acc: 0.9819
loss: 0.0530, acc: 0.9818
loss: 0.0518, acc: 0.9818
> val_acc: 0.8072, val_f1: 0.7652
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.0247, acc: 0.9922
loss: 0.0227, acc: 0.9931
loss: 0.0318, acc: 0.9933
loss: 0.0286, acc: 0.9934
loss: 0.0311, acc: 0.9922
loss: 0.0283, acc: 0.9914
loss: 0.0312, acc: 0.9917
loss: 0.0297, acc: 0.9912
loss: 0.0291, acc: 0.9908
loss: 0.0291, acc: 0.9904
loss: 0.0286, acc: 0.9902
loss: 0.0276, acc: 0.9905
loss: 0.0299, acc: 0.9897
loss: 0.0341, acc: 0.9882
> val_acc: 0.7962, val_f1: 0.7536
>> test_acc: 0.8150, test_f1: 0.7804
cuda memory allocated: 2558812672
> n_trainable_params: 124647939, n_nontrainable_params: 0
> training arguments:
>>> model_name: roberta
>>> dataset: lap14
>>> optimizer: adam
>>> repeat: 3
>>> lr: 2e-05
>>> l2reg: 0.0001
>>> num_epoch: 100
>>> batch_size: 16
>>> log_step: 10
>>> bert_dim: 768
>>> max_seq_len: 128
>>> polarities_dim: 3
>>> patience: 5
>>> device: cuda
>>> seed: 42
>>> save_model_dir: /media/b115/Backup/NLP
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.0768, acc: 0.4250
loss: 1.0654, acc: 0.4188
loss: 1.0471, acc: 0.4583
loss: 1.0104, acc: 0.5047
loss: 0.9674, acc: 0.5400
loss: 0.9127, acc: 0.5760
loss: 0.8866, acc: 0.5902
loss: 0.8596, acc: 0.6070
loss: 0.8364, acc: 0.6250
loss: 0.8053, acc: 0.6425
loss: 0.7855, acc: 0.6528
loss: 0.7734, acc: 0.6620
loss: 0.7551, acc: 0.6726
loss: 0.7520, acc: 0.6750
> val_acc: 0.7398, val_f1: 0.7001
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.7398_f1_0.7001_230828-0401.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.5304, acc: 0.7344
loss: 0.4306, acc: 0.8259
loss: 0.4794, acc: 0.8151
loss: 0.4703, acc: 0.8143
loss: 0.4445, acc: 0.8224
loss: 0.4302, acc: 0.8333
loss: 0.4362, acc: 0.8330
loss: 0.4471, acc: 0.8269
loss: 0.4429, acc: 0.8281
loss: 0.4473, acc: 0.8265
loss: 0.4472, acc: 0.8275
loss: 0.4463, acc: 0.8295
loss: 0.4349, acc: 0.8332
loss: 0.4282, acc: 0.8368
loss: 0.4328, acc: 0.8346
> val_acc: 0.8041, val_f1: 0.7708
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8041_f1_0.7708_230828-0402.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.2896, acc: 0.8750
loss: 0.2635, acc: 0.9028
loss: 0.3016, acc: 0.8973
loss: 0.2958, acc: 0.8914
loss: 0.2966, acc: 0.8906
loss: 0.2938, acc: 0.8890
loss: 0.2917, acc: 0.8925
loss: 0.2857, acc: 0.8974
loss: 0.2824, acc: 0.9006
loss: 0.2766, acc: 0.9018
loss: 0.2724, acc: 0.9039
loss: 0.2712, acc: 0.9047
loss: 0.2757, acc: 0.9043
loss: 0.2796, acc: 0.9031
> val_acc: 0.8056, val_f1: 0.7650
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8056_f1_0.765_230828-0402.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.1923, acc: 0.9688
loss: 0.2239, acc: 0.9271
loss: 0.2103, acc: 0.9261
loss: 0.2020, acc: 0.9316
loss: 0.1815, acc: 0.9390
loss: 0.1846, acc: 0.9375
loss: 0.1890, acc: 0.9355
loss: 0.1803, acc: 0.9384
loss: 0.1796, acc: 0.9390
loss: 0.1789, acc: 0.9402
loss: 0.1783, acc: 0.9400
loss: 0.1817, acc: 0.9392
loss: 0.1877, acc: 0.9355
loss: 0.1886, acc: 0.9361
loss: 0.1945, acc: 0.9331
> val_acc: 0.7994, val_f1: 0.7632
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.1029, acc: 0.9792
loss: 0.1076, acc: 0.9609
loss: 0.1016, acc: 0.9663
loss: 0.1003, acc: 0.9635
loss: 0.1143, acc: 0.9592
loss: 0.1094, acc: 0.9632
loss: 0.1343, acc: 0.9545
loss: 0.1410, acc: 0.9498
loss: 0.1427, acc: 0.9491
loss: 0.1488, acc: 0.9486
loss: 0.1497, acc: 0.9487
loss: 0.1504, acc: 0.9499
loss: 0.1511, acc: 0.9494
loss: 0.1535, acc: 0.9499
loss: 0.1493, acc: 0.9519
> val_acc: 0.7947, val_f1: 0.7612
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.0800, acc: 0.9563
loss: 0.0806, acc: 0.9656
loss: 0.0999, acc: 0.9688
loss: 0.1083, acc: 0.9672
loss: 0.0951, acc: 0.9700
loss: 0.1003, acc: 0.9667
loss: 0.0947, acc: 0.9688
loss: 0.0915, acc: 0.9680
loss: 0.0986, acc: 0.9660
loss: 0.0977, acc: 0.9663
loss: 0.1018, acc: 0.9665
loss: 0.1017, acc: 0.9672
loss: 0.1065, acc: 0.9654
loss: 0.1120, acc: 0.9621
> val_acc: 0.7994, val_f1: 0.7580
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.1669, acc: 0.9375
loss: 0.1135, acc: 0.9732
loss: 0.1067, acc: 0.9740
loss: 0.1007, acc: 0.9743
loss: 0.0917, acc: 0.9744
loss: 0.1010, acc: 0.9688
loss: 0.1067, acc: 0.9668
loss: 0.1054, acc: 0.9662
loss: 0.1035, acc: 0.9673
loss: 0.0989, acc: 0.9681
loss: 0.1036, acc: 0.9645
loss: 0.1061, acc: 0.9644
loss: 0.1032, acc: 0.9652
loss: 0.1046, acc: 0.9650
loss: 0.1009, acc: 0.9666
> val_acc: 0.8025, val_f1: 0.7650
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.0276, acc: 0.9922
loss: 0.0441, acc: 0.9826
loss: 0.0693, acc: 0.9732
loss: 0.0742, acc: 0.9688
loss: 0.0724, acc: 0.9701
loss: 0.0645, acc: 0.9741
loss: 0.0667, acc: 0.9724
loss: 0.0659, acc: 0.9736
loss: 0.0670, acc: 0.9709
loss: 0.0661, acc: 0.9719
loss: 0.0789, acc: 0.9676
loss: 0.0810, acc: 0.9682
loss: 0.0818, acc: 0.9688
loss: 0.0816, acc: 0.9697
> val_acc: 0.8103, val_f1: 0.7770
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8103_f1_0.777_230828-0404.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.0296, acc: 1.0000
loss: 0.0895, acc: 0.9792
loss: 0.0683, acc: 0.9773
loss: 0.0669, acc: 0.9746
loss: 0.0665, acc: 0.9792
loss: 0.0726, acc: 0.9772
loss: 0.0700, acc: 0.9788
loss: 0.0676, acc: 0.9792
loss: 0.0698, acc: 0.9794
loss: 0.0661, acc: 0.9796
loss: 0.0723, acc: 0.9786
loss: 0.0760, acc: 0.9777
loss: 0.0809, acc: 0.9764
loss: 0.0773, acc: 0.9782
loss: 0.0750, acc: 0.9780
> val_acc: 0.8135, val_f1: 0.7866
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8135_f1_0.7866_230828-0405.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.0826, acc: 0.9688
loss: 0.0503, acc: 0.9844
loss: 0.0655, acc: 0.9808
loss: 0.0566, acc: 0.9826
loss: 0.0572, acc: 0.9810
loss: 0.0533, acc: 0.9821
loss: 0.0582, acc: 0.9801
loss: 0.0586, acc: 0.9803
loss: 0.0670, acc: 0.9767
loss: 0.0626, acc: 0.9785
loss: 0.0640, acc: 0.9782
loss: 0.0644, acc: 0.9779
loss: 0.0660, acc: 0.9772
loss: 0.0757, acc: 0.9743
loss: 0.0776, acc: 0.9738
> val_acc: 0.8182, val_f1: 0.7850
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8182_f1_0.785_230828-0405.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.0436, acc: 0.9938
loss: 0.0297, acc: 0.9969
loss: 0.0321, acc: 0.9958
loss: 0.0293, acc: 0.9969
loss: 0.0291, acc: 0.9950
loss: 0.0321, acc: 0.9917
loss: 0.0297, acc: 0.9929
loss: 0.0301, acc: 0.9922
loss: 0.0287, acc: 0.9924
loss: 0.0292, acc: 0.9925
loss: 0.0301, acc: 0.9909
loss: 0.0301, acc: 0.9906
loss: 0.0362, acc: 0.9885
loss: 0.0392, acc: 0.9879
> val_acc: 0.7947, val_f1: 0.7458
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.0237, acc: 0.9844
loss: 0.0154, acc: 0.9955
loss: 0.0199, acc: 0.9948
loss: 0.0231, acc: 0.9926
loss: 0.0381, acc: 0.9872
loss: 0.0407, acc: 0.9861
loss: 0.0401, acc: 0.9863
loss: 0.0399, acc: 0.9856
loss: 0.0365, acc: 0.9874
loss: 0.0438, acc: 0.9847
loss: 0.0425, acc: 0.9850
loss: 0.0399, acc: 0.9863
loss: 0.0420, acc: 0.9859
loss: 0.0415, acc: 0.9860
loss: 0.0422, acc: 0.9861
> val_acc: 0.8182, val_f1: 0.7861
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.0289, acc: 0.9922
loss: 0.0251, acc: 0.9931
loss: 0.0215, acc: 0.9933
loss: 0.0234, acc: 0.9901
loss: 0.0198, acc: 0.9922
loss: 0.0210, acc: 0.9914
loss: 0.0241, acc: 0.9908
loss: 0.0268, acc: 0.9896
loss: 0.0289, acc: 0.9886
loss: 0.0272, acc: 0.9892
loss: 0.0343, acc: 0.9873
loss: 0.0354, acc: 0.9873
loss: 0.0345, acc: 0.9878
loss: 0.0376, acc: 0.9860
> val_acc: 0.7947, val_f1: 0.7491
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.0074, acc: 1.0000
loss: 0.0454, acc: 0.9792
loss: 0.0361, acc: 0.9830
loss: 0.0332, acc: 0.9844
loss: 0.0307, acc: 0.9851
loss: 0.0290, acc: 0.9868
loss: 0.0281, acc: 0.9879
loss: 0.0278, acc: 0.9878
loss: 0.0297, acc: 0.9870
loss: 0.0339, acc: 0.9857
loss: 0.0371, acc: 0.9847
loss: 0.0394, acc: 0.9838
loss: 0.0430, acc: 0.9831
loss: 0.0459, acc: 0.9806
loss: 0.0461, acc: 0.9806
> val_acc: 0.7931, val_f1: 0.7463
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.0921, acc: 0.9792
loss: 0.0440, acc: 0.9922
loss: 0.0355, acc: 0.9928
loss: 0.0360, acc: 0.9913
loss: 0.0320, acc: 0.9918
loss: 0.0300, acc: 0.9911
loss: 0.0293, acc: 0.9896
loss: 0.0289, acc: 0.9893
loss: 0.0272, acc: 0.9898
loss: 0.0289, acc: 0.9902
loss: 0.0283, acc: 0.9906
loss: 0.0269, acc: 0.9908
loss: 0.0255, acc: 0.9911
loss: 0.0267, acc: 0.9908
loss: 0.0279, acc: 0.9905
> val_acc: 0.7962, val_f1: 0.7484
>> test_acc: 0.8182, test_f1: 0.7850
cuda memory allocated: 2569167360
> n_trainable_params: 124647939, n_nontrainable_params: 0
> training arguments:
>>> model_name: roberta
>>> dataset: lap14
>>> optimizer: adam
>>> repeat: 3
>>> lr: 2e-05
>>> l2reg: 0.0001
>>> num_epoch: 100
>>> batch_size: 16
>>> log_step: 10
>>> bert_dim: 768
>>> max_seq_len: 128
>>> polarities_dim: 3
>>> patience: 5
>>> device: cuda
>>> seed: 42
>>> save_model_dir: /media/b115/Backup/NLP
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.0686, acc: 0.4750
loss: 1.0851, acc: 0.4219
loss: 1.0849, acc: 0.4292
loss: 1.0763, acc: 0.4422
loss: 1.0567, acc: 0.4637
loss: 1.0243, acc: 0.4969
loss: 0.9866, acc: 0.5259
loss: 0.9356, acc: 0.5617
loss: 0.9163, acc: 0.5799
loss: 0.8940, acc: 0.5944
loss: 0.8627, acc: 0.6108
loss: 0.8469, acc: 0.6203
loss: 0.8274, acc: 0.6337
loss: 0.8142, acc: 0.6415
> val_acc: 0.7665, val_f1: 0.6942
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.7665_f1_0.6942_230828-0408.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.5780, acc: 0.7812
loss: 0.5029, acc: 0.8259
loss: 0.5072, acc: 0.8047
loss: 0.5230, acc: 0.8033
loss: 0.5274, acc: 0.7955
loss: 0.5298, acc: 0.7975
loss: 0.5187, acc: 0.8008
loss: 0.5080, acc: 0.8057
loss: 0.4974, acc: 0.8110
loss: 0.5022, acc: 0.8078
loss: 0.5154, acc: 0.8017
loss: 0.5142, acc: 0.7999
loss: 0.5135, acc: 0.8004
loss: 0.5101, acc: 0.8027
loss: 0.5040, acc: 0.8064
> val_acc: 0.8088, val_f1: 0.7684
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8088_f1_0.7684_230828-0409.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.3465, acc: 0.8750
loss: 0.3442, acc: 0.8681
loss: 0.3209, acc: 0.8750
loss: 0.3201, acc: 0.8783
loss: 0.3087, acc: 0.8789
loss: 0.3054, acc: 0.8836
loss: 0.3185, acc: 0.8768
loss: 0.3199, acc: 0.8726
loss: 0.3305, acc: 0.8686
loss: 0.3246, acc: 0.8718
loss: 0.3207, acc: 0.8738
loss: 0.3254, acc: 0.8729
loss: 0.3250, acc: 0.8745
loss: 0.3307, acc: 0.8727
> val_acc: 0.7962, val_f1: 0.7577
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.4338, acc: 0.8750
loss: 0.2185, acc: 0.9479
loss: 0.1826, acc: 0.9545
loss: 0.2113, acc: 0.9316
loss: 0.2366, acc: 0.9167
loss: 0.2442, acc: 0.9135
loss: 0.2404, acc: 0.9133
loss: 0.2470, acc: 0.9106
loss: 0.2373, acc: 0.9146
loss: 0.2331, acc: 0.9164
loss: 0.2220, acc: 0.9203
loss: 0.2278, acc: 0.9180
loss: 0.2432, acc: 0.9139
loss: 0.2451, acc: 0.9138
loss: 0.2420, acc: 0.9151
> val_acc: 0.8103, val_f1: 0.7691
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8103_f1_0.7691_230828-0410.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.1191, acc: 0.9688
loss: 0.1352, acc: 0.9570
loss: 0.1347, acc: 0.9567
loss: 0.1409, acc: 0.9514
loss: 0.1555, acc: 0.9402
loss: 0.1544, acc: 0.9408
loss: 0.1612, acc: 0.9384
loss: 0.1582, acc: 0.9400
loss: 0.1611, acc: 0.9397
loss: 0.1605, acc: 0.9408
loss: 0.1629, acc: 0.9393
loss: 0.1697, acc: 0.9380
loss: 0.1674, acc: 0.9395
loss: 0.1650, acc: 0.9407
loss: 0.1656, acc: 0.9407
> val_acc: 0.8135, val_f1: 0.7665
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8135_f1_0.7665_230828-0410.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.1618, acc: 0.9437
loss: 0.1461, acc: 0.9469
loss: 0.1553, acc: 0.9417
loss: 0.1651, acc: 0.9391
loss: 0.1503, acc: 0.9475
loss: 0.1507, acc: 0.9500
loss: 0.1524, acc: 0.9482
loss: 0.1489, acc: 0.9492
loss: 0.1412, acc: 0.9521
loss: 0.1396, acc: 0.9537
loss: 0.1304, acc: 0.9574
loss: 0.1291, acc: 0.9589
loss: 0.1313, acc: 0.9577
loss: 0.1309, acc: 0.9576
> val_acc: 0.8197, val_f1: 0.7839
>> saved: /media/b115/Backup/NLP/roberta/lap14/acc_0.8197_f1_0.7839_230828-0411.model
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.1729, acc: 0.9375
loss: 0.1166, acc: 0.9643
loss: 0.1007, acc: 0.9714
loss: 0.0872, acc: 0.9761
loss: 0.0772, acc: 0.9773
loss: 0.0721, acc: 0.9769
loss: 0.0794, acc: 0.9756
loss: 0.0799, acc: 0.9747
loss: 0.0885, acc: 0.9740
loss: 0.0935, acc: 0.9707
loss: 0.0968, acc: 0.9663
loss: 0.0985, acc: 0.9660
loss: 0.1037, acc: 0.9637
loss: 0.1053, acc: 0.9636
loss: 0.1027, acc: 0.9648
> val_acc: 0.8025, val_f1: 0.7660
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.0645, acc: 0.9844
loss: 0.0530, acc: 0.9861
loss: 0.0479, acc: 0.9844
loss: 0.0399, acc: 0.9885
loss: 0.0416, acc: 0.9896
loss: 0.0599, acc: 0.9806
loss: 0.0604, acc: 0.9779
loss: 0.0659, acc: 0.9784
loss: 0.0675, acc: 0.9773
loss: 0.0647, acc: 0.9783
loss: 0.0632, acc: 0.9792
loss: 0.0661, acc: 0.9778
loss: 0.0667, acc: 0.9771
loss: 0.0775, acc: 0.9733
> val_acc: 0.8135, val_f1: 0.7820
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.1119, acc: 1.0000
loss: 0.0890, acc: 0.9635
loss: 0.0824, acc: 0.9744
loss: 0.0710, acc: 0.9785
loss: 0.0620, acc: 0.9807
loss: 0.0635, acc: 0.9784
loss: 0.0646, acc: 0.9768
loss: 0.0601, acc: 0.9783
loss: 0.0585, acc: 0.9771
loss: 0.0626, acc: 0.9776
loss: 0.0630, acc: 0.9779
loss: 0.0659, acc: 0.9782
loss: 0.0678, acc: 0.9785
loss: 0.0688, acc: 0.9782
loss: 0.0741, acc: 0.9767
> val_acc: 0.8103, val_f1: 0.7792
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.0770, acc: 0.9792
loss: 0.0448, acc: 0.9844
loss: 0.0511, acc: 0.9832
loss: 0.0635, acc: 0.9826
loss: 0.0550, acc: 0.9851
loss: 0.0541, acc: 0.9855
loss: 0.0511, acc: 0.9858
loss: 0.0561, acc: 0.9836
loss: 0.0606, acc: 0.9826
loss: 0.0609, acc: 0.9818
loss: 0.0641, acc: 0.9800
loss: 0.0685, acc: 0.9790
loss: 0.0673, acc: 0.9797
loss: 0.0682, acc: 0.9784
loss: 0.0666, acc: 0.9794
> val_acc: 0.8041, val_f1: 0.7644
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.0191, acc: 0.9938
loss: 0.0196, acc: 0.9938
loss: 0.0271, acc: 0.9896
loss: 0.0237, acc: 0.9906
loss: 0.0224, acc: 0.9912
loss: 0.0405, acc: 0.9865
loss: 0.0530, acc: 0.9830
loss: 0.0529, acc: 0.9828
loss: 0.0578, acc: 0.9819
loss: 0.0566, acc: 0.9825
loss: 0.0582, acc: 0.9818
loss: 0.0602, acc: 0.9812
loss: 0.0606, acc: 0.9812
loss: 0.0612, acc: 0.9812
> val_acc: 0.7994, val_f1: 0.7597
>> test_acc: 0.8197, test_f1: 0.7839
>> test_acc: 0.8150, test_f1: 0.7804
>> test_acc: 0.8182, test_f1: 0.7850
>> test_acc: 0.8197, test_f1: 0.7839

>> avg_test_acc: 0.8177, avg_test_f1: 0.7831
>> max_test_acc: 0.8197, max_test_f1: 0.7850
